openapi: 3.0.0
info:
  version: 1.0.0
  title: Универсальный API мобильного приложения «ЛекарстваTime»
  description: >-
    Универсальный API мобильного приложения «ЛекарстваTime» для взаимодействия с
    пользователем, БД лекарств, графиком и уведомлений
paths:
 /auth/register:
    post:
      summary: Регистрация нового пользователя в системе 
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                nameNick:
                  type: string
                  example: Daria13s
                  description: Псевдоним пользователя
                sex:
                  type: string
                  enum:
                    - female
                    - male
                  description: Пол пользователя
                birthYear:
                  type: string
                  format: year
                  example: 1991
                  description: Год рождения пользователя
                mobilePhone:
                  type: string
                  example: 79279000006
                  description: Номер телефона пользователя
                password:
                  type: integer
                  example: 4455
                  description: ПИН-код пароль для входа в приложение. Устанавливается пользователем
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  userId:
                    type: integer
                    description: Идентификатор пользователя
        '400':
          description: Ошибка при регистрации 
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
 /auth/login:
    post:
      summary: Авторизация в системе
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                mobilePhone:
                  type: string
                  example: 79279000006
                  description: Номер телефона пользователя
                password:
                  type: integer
                  example: 4455
                  description: ПИН-код пароль для входа в приложение. Устанавливается пользователем
      responses:
        '200':
          description: Успешная аутентификация
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: integer
                    description: Токен доступа к серверу
                    example: 123456
        '400':
          description: Проблема аутентификации
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
 /auth/user:
    put:
      summary: Изменение информации о пользователе
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                  description: Идентификатор пользователя
                nameNick:
                  type: string
                  example: Daria13s
                  description: Псевдоним пользователя
                sex:
                  type: string
                  enum:
                    - female
                    - male
                  description: Пол пользователя
                birthYear:
                  type: string
                  format: year
                  example: 1991
                  description: Год рождения пользователя
                mobilePhone:
                  type: string
                  example: 79279000006
                  description: Номер телефона пользователя
                password:
                  type: integer
                  example: 1300
                  description: ПИН-код пароль для входа в приложение. Устанавливается пользователем
      responses:
        '200':
          description: OK
        '500':
          description: ошибка сервера
        '503':
          description: сервис недоступен
 /question:
    post:
      summary: Добавление информации о работе приложения
      description: Вопросы с ответами, описывающие функциональность приложения и возможные проблемы, с которыми может столкнуться пользователь
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                question:
                  type: string
                  example: Вопрос №1
                  description: Текст вопроса / описание проблемы
                answer:
                  type: string
                  example: Ответ №1
                  description: Текст ответа
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  listId:
                    type: integer
                    description: Идентификатор вопроса и ответа на него
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
    put:
      summary: Изменение текста вопроса и ответа на него
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                listId:
                  type: integer
                  description: Идентификатор вопроса и ответа на него
                question:
                  type: string
                  example: Вопрос №1
                  description: Текст вопроса
                answer:
                  type: string
                  example: Ответ №1
                  description: Текст ответа
      responses:
        '200':
          description: OK
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
    delete:
      summary: Удаление записи по идентификатору вопроса и ответа на него
      parameters:
        - name: listId
          in: query
          description: Идентификатор вопроса и ответа на него
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ok
        '400':
          description: Ошибочный запрос
        '500':
          description:Ошибка сервера
        '503':
          description: Сервис недоступен
 /info:
    get:
      summary: Просмотр информации о работе приложения
      description: Информация представлена в виде раскрывающегося списка "Вопрос-Ответ"
      parameters:
        - name: userId
          in: query
          description: Идентификатор пользователя
          required: true
          schema:
            type: integer
        - name: listId
          in: query
          description: Идентификатор вопроса и ответа на него
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  listId:
                    type: integer
                    description: Идентификатор вопроса и ответа на него
                  question:
                    type: string
                    example: Вопрос №1
                    description: текст вопроса
                  answer:
                    type: string
                    example: Ответ №1
                    description: Текст ответа
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
 /foto:
    get:
      summary: Загрузка фотографии из галереи
      description: Данный запрос принимает только изображения формата .jpg/.jpeg/.pdf. Пустые изображения и невалидные изображения не разрешены
      parameters:
        - name: userId
          in: query
          description: Идентификатор пользователя
          required: true
          schema:
            type: integer
        - name: imageId
          in: query
          description: Идентификатор изображения
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                    imageId:
                      type: integer
                      description: Идентификатор изображения
                    imageFile:
                      type: string
                      format: binary
                      description: Файл изображения в формате .jpg/.jpeg/.pdf
                    imageSize:
                      type: integer
                      description: Размер изображения
        '500':
          description: Ошибка сервера
        '503':
          description:Сервис недоступен
    delete:
      summary: Удаление фотографии по идентификатору
      parameters:
        - name: imageId
          in: query
          description: Идентификатор изображения
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ok
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен 
 /drug:
    get:
      summary: Получение из БД информации о лекарстве
      parameters:
        - name: drugId
          in: query
          description: Идентификатор лекарства
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  drugId:
                    type: integer
                    description: Идентификатор лекарства
                  drugManual:
                    type: string
                    description: Инструкция по применению лекарства
        '400':
          description: Ошибочный запрос
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
 /schedule:
    post:
      summary: Создание графика приема лекарств
      description: Для создания графика требуется, чтобы все предложенные поля были корректно заполнены пользователем, иначе график не будет создан
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                  description: Идентификатор пользователя
                drugId:
                  type: integer
                  description: Идентификатор лекарства
                drugName:
                  type: string
                  example: Нурофен
                  description: Название лекарства
                amount:
                  type: number
                  example: 30
                  description: Количество в упаковке
                dosage:
                  type: number
                  example: 2,5
                  description: Дозировка лекарства
                dayWeek:
                  type: string
                  enum:
                    - monday
                    - tuesday
                    - wednesday
                    - thursday
                    - friday
                    - saturday
                    - sunday
                  description: День недели приема лекарства
                timeReception:
                  type: string
                  format: time
                  example: 10:50
                  description: Время приема лекарства
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  scheduleId:
                    type: integer
                    description: Идентификатор графика приема лекарств
        '400':
          description: Ошибочный запрос
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
    get:
      summary: Просмотр графика приема лекарств
      description: Получение файла графика в формате .jpg для просмотра
      parameters:
        - name: userId
          in: query
          description: Идентификатор пользователя
          required: true
          schema:
            type: integer
        - name: scheduleId
          in: query
          description: Идентификатор графика приема лекарств
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  scheduleId:
                    type: integer
                    description: Идентификатор графика приема лекарств
                  scheduleFile:
                    type: string
                    format: binary
                    description: Файл графика в формате .jpg
        '500':
          description: Ошибка сервера
        '503':
          description: Сервис недоступен
    put:
      summary: Изменение данных для графика приема лекарств
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                userId:
                  type: integer
                  description: идентификатор пользователя
                scheduleId:
                  type: integer
                  description: Идентификатор графика приема лекарств
                drugId:
                  type: integer
                  description: Идентификатор лекарства
                drugName:
                  type: string
                  example: Нурофен
                  description: Название лекарства
                amount:
                  type: number
                  example: 30
                  description: количество в упаковке
                dosage:
                  type: number
                  example: 2,5
                  description: дозировка лекарства
                dayWeek:
                  type: string
                  enum:
                    - monday
                    - tuesday
                    - wednesday
                    - thursday
                    - friday
                    - saturday
                    - sunday
                  description: День недели приема лекарства
                timeReception:
                  type: string
                  format: time
                  example: 09:30
                  description: время приема лекарства
      responses:
        '200':
          description: OK
        '500':
          description: ошибка сервера
        '503':
          description: сервис недоступен
    delete:
      summary: Удаление графика приема лекарств по идентификатору
      parameters:
        - name: scheduleId
          in: query
          description: идентификатор графика приема лекарств
          required: true
          schema:
            type: integer
      responses:
        '200':
          description: ok
        '500':
          description: ошибка сервера
        '503':
          description: сервис недоступен
 /notification:
    post:
      summary: Создание push-уведомления
      description: При создании графика система предлагает пользователю установить напоминание о необходимости приема лекарства. Если пользователь подтверждает установку напоминания, то система отправляет push-уведомления в соответствии с графиком; рассчитывает срок завершения упаковки, исходя из количества в ней и дозировки, и предупреждает о необходимости купить лекарство за 2 дня.
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                scheduleId:
                  type: integer
                  description: Идентификатор графика приема лекарств
                pushFlag:
                  type: boolean
                  example: true
                  description: подтверждение установки напоминания true - да; false - нет
                reminder:
                  type: string
                  description: Текст напоминания о необходимости приема лекарства
                notify:
                  type: string
                  description: Текст уведомления о необходимости купить лекарство
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                properties:
                  pushId:
                    type: integer
                    description: Идентификатор push-уведомления
        '400':
          description: ошибочный запрос
        '500':
          description: ошибка сервера
        '503':
          description: сервис недоступен
    put:
      summary: Изменение статуса установки напоминания
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                scheduleId:
                  type: integer
                  description: Идентификатор графика приема лекарств
                pushFlag:
                  type: boolean
                  example: false
                  description: Подтверждение установки напоминания true - да; false - нет
      responses:
        '200':
          description: OK
        '500':
          description: ошибка сервера
        '503':
          description: сервис недоступен
